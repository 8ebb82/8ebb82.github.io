<!DOCTYPE html>
<html lang="zh-cn">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>kotlin 基本语法 | xici&#39;s Web Note</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
<script>
    mermaid.initialize({ startOnLoad: true });
</script>
  </head>

  <body>
    <nav>
    <ul class="menu">
      
      <li><a href="/posts/">文章</a></li>
      
      <li><a href="/tags/">标签</a></li>
      
      <li><a href="/categories/">分类</a></li>
      
    </ul>
    <hr/>
    </nav>

<div class="article-meta">
    <h1>
        <span class="title">
            kotlin 基本语法
        </span>
    </h1>
    
    <h2 class="date">2025/03/15</h2>
    
</div>

<main>
    <h1 id="hello-kotlin">hello kotlin</h1>
<p>在 IDEA 中新建一个 kotlin 项目，添加“ kotlin 文件”（注意不是类），输入以下代码，然后构建并运行，即可在终端看到输出。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(){
</span></span><span style="display:flex;"><span>	println(<span style="color:#e6db74">&#34;hello kotlin&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>语句末尾不需要分号。</p>
<h1 id="变量声明">变量声明</h1>
<p>kotlin 只有两种变量声明关键字：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> a = <span style="color:#ae81ff">10</span> <span style="color:#75715e">// 不可变变量
</span></span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> b = <span style="color:#ae81ff">20</span> <span style="color:#75715e">// 可变变量
</span></span></span></code></pre></div><p>kotlin 可自动推导变量类型。也可显式声明变量类型。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> a : Int = <span style="color:#ae81ff">10</span> <span style="color:#75715e">// 显式声明
</span></span></span><span style="display:flex;"><span><span style="color:#66d9ef">val</span> a = <span style="color:#ae81ff">10</span> <span style="color:#75715e">// 隐式声明
</span></span></span></code></pre></div><p><code>Int</code>为对象类型，而非 java 中的基本数据类型<code>int</code>。 kotlin 完全舍弃了 java 中的基本数据类型，每一个变量都是对象。</p>
<h1 id="函数声明">函数声明</h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">funName</span>(param1 : Int , param2 : Int) : Int{
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// code
</span></span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li><code>param1 : Int , param2 : Int</code>声明变量名及其类型</li>
<li><code>: Int</code>声明返回值类型，不声明时返回空。</li>
</ul>
<p>两者都是可选的。</p>
<h2 id="语法糖">语法糖</h2>
<p>当函数体只有一行时，可写为：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">funName</span>(param1 : Int , param2 : Int) : Int = max(param1 : Int , param2 : Int)
</span></span></code></pre></div><p>这里以<code>max</code>函数为例子，其作用是返回两者中较大的一个。</p>
<h1 id="流程控制">流程控制</h1>
<h2 id="if">if</h2>
<p>kotlin 中 if 有返回值：条件分支中的最后一行代码的返回值。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">funName</span>(num1 : Int , num2 : Int) : Int{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">val</span> value = <span style="color:#66d9ef">if</span>(num1&gt;num2){
</span></span><span style="display:flex;"><span>		num1
</span></span><span style="display:flex;"><span>	}<span style="color:#66d9ef">else</span>{
</span></span><span style="display:flex;"><span>		num2
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">value</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>显然<code>value</code>是多余的，可以直接返回判断体：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">funName</span>(num1 : Int , num2 : Int) : <span style="color:#66d9ef">if</span>(num1&gt;num2) num1 <span style="color:#66d9ef">else</span> num2
</span></span></code></pre></div><p>这里写成了<a href="#%E8%AF%AD%E6%B3%95%E7%B3%96">语法糖</a>。</p>
<p>一般 if 语句不止一行，为什么也可以写成语法糖呢？我的理解是，如果函数体中只有一个逻辑块（一个判断流程，一条赋值语句等），就可以写成语法糖。</p>
<h2 id="when">when</h2>
<p>作用约等于<code>switch</code>。</p>
<p>格式：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">when</span>( <span style="color:#f92672">..</span>. ){
</span></span><span style="display:flex;"><span>	匹配值 <span style="color:#f92672">-&gt;</span> { 执行逻辑 }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="精确匹配">精确匹配</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">funName</span>(name : String) = <span style="color:#66d9ef">when</span>(name){
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;Tom&#34;</span> <span style="color:#f92672">-&gt;</span> { <span style="color:#ae81ff">86</span> }
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;Jim&#34;</span> <span style="color:#f92672">-&gt;</span> <span style="color:#ae81ff">77</span> <span style="color:#75715e">// 当只有一行时，花括号可以省略。
</span></span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">else</span> <span style="color:#f92672">-&gt;</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="类型匹配">类型匹配</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">funName</span>(num : Number) = <span style="color:#66d9ef">when</span>(num){
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">is</span> Int <span style="color:#f92672">-&gt;</span> println(<span style="color:#e6db74">&#34;num is Int&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">is</span> Double <span style="color:#f92672">-&gt;</span> println(<span style="color:#e6db74">&#34;num is Double&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">else</span> <span style="color:#f92672">-&gt;</span> prinln(<span style="color:#e6db74">&#34;num not support&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><code>is</code> 是 kotlin 的关键字，作用就像 java 中的<code>instanceof</code>一样。</p>
<h3 id="无参写法">无参写法</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">funName</span>(name : String) = <span style="color:#66d9ef">when</span>{
</span></span><span style="display:flex;"><span>	name <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;Tom&#34;</span> <span style="color:#f92672">-&gt;</span> <span style="color:#ae81ff">86</span>
</span></span><span style="display:flex;"><span>	name <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;Jim&#34;</span> <span style="color:#f92672">-&gt;</span> <span style="color:#ae81ff">77</span>
</span></span><span style="display:flex;"><span>	name.startsWith(<span style="color:#e6db74">&#34;Mike&#34;</span>) <span style="color:#f92672">-&gt;</span> <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">else</span> <span style="color:#f92672">-&gt;</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>可用于模糊匹配。</p>
<p>kotlin 中比较两个对象是否相同可以用 <code>==</code>， java 中需要用<code>equals</code>函数。</p>
<h1 id="循环控制">循环控制</h1>
<h2 id="for-in">for-in</h2>
<h3 id="区间定义">区间定义</h3>
<p>定义一个闭区间：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> range = <span style="color:#ae81ff">0</span><span style="color:#f92672">..</span><span style="color:#ae81ff">10</span> <span style="color:#75715e">// 即[0,10]
</span></span></span></code></pre></div><p>其中<code>..</code>是关键字。</p>
<p>左闭右开区间：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>range = <span style="color:#ae81ff">0</span> until <span style="color:#ae81ff">10</span> <span style="color:#75715e">// [0,10)
</span></span></span></code></pre></div><p>降序区间：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>range = <span style="color:#ae81ff">10</span> downTo <span style="color:#ae81ff">0</span> <span style="color:#75715e">// [10,0]
</span></span></span></code></pre></div><h3 id="例子">例子</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">funName</span>(){
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span>(i <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">0</span><span style="color:#f92672">..</span><span style="color:#ae81ff">10</span>){
</span></span><span style="display:flex;"><span>		<span style="color:#75715e">// code
</span></span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">funName</span>(){
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span>(i <span style="color:#66d9ef">in</span> range){
</span></span><span style="display:flex;"><span>		<span style="color:#75715e">// code
</span></span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="变量自增">变量自增</h3>
<p>使用<code>step</code>关键字。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">funName</span>(){
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span>(i <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">0</span><span style="color:#f92672">..</span><span style="color:#ae81ff">10</span> step <span style="color:#ae81ff">2</span>){
</span></span><span style="display:flex;"><span>		<span style="color:#75715e">// code
</span></span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>每次循环之间 i 自增2。如果不写则默认自增1。</p>
<h1 id="面向对象">面向对象</h1>
<p>Person 类：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Person</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">var</span> name = <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">var</span> age = <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">eat</span>() {
</span></span><span style="display:flex;"><span>		println(name + <span style="color:#e6db74">&#34; is eating. He is &#34;</span> + age + <span style="color:#e6db74">&#34; years old.&#34;</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>实例化：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> p = Person()
</span></span></code></pre></div><p>没有像 java 中的<code>new</code>关键字。</p>
<h1 id="继承与接口">继承与接口</h1>
<p>kotlin 中默认每一个非抽象类都是无法继承的。使用<code>open</code>关键字让类变为可继承。</p>
<p>抽象类无法创建实例，必须被继承后才能实例化。所以抽象类必须是可继承的。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">open</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Person</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// code
</span></span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Student</span> : Person() {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">var</span> sno = <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">var</span> grade = <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>子类使用<code>:</code>来继承父类。同时实现接口也是这个关键字。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Student</span> : Person(), Study {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">var</span> sno = <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">var</span> grade = <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="单例类">单例类</h2>
<p>在内存中只有一个实例的类。</p>
<p>使用<code>object</code>关键字。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">object</span> <span style="color:#a6e22e">Singleton</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">singletonFun</span>() {
</span></span><span style="display:flex;"><span>		println(<span style="color:#e6db74">&#34;singletonFun&#34;</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="数据类">数据类</h2>
<p>数据类是一种只保存数据的类。</p>
<p>使用<code>data</code>关键字。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">data</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Person</span>(<span style="color:#66d9ef">val</span> name: String, <span style="color:#66d9ef">val</span> age: Int)
</span></span></code></pre></div><h1 id="空指针检查">空指针检查</h1>
<p>kotlin 在编译时进行空指针检查，而非运行时。</p>
<p>kotlin 默认所有参数都是非空的，如果想声明一个可为空的变量，需要在变量类型后加<code>?</code>。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> name : String? = <span style="color:#66d9ef">null</span>
</span></span></code></pre></div><p><code>?</code>表示这个变量可以为空。</p>
<h2 id="判空辅助操作符">判空辅助操作符</h2>
<p><code>?.</code>：如果对象为空则返回 null，否则执行后面的操作。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">if</span>(a <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span>){
</span></span><span style="display:flex;"><span>	a.method()
</span></span><span style="display:flex;"><span>}<span style="color:#66d9ef">else</span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">null</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>等价于：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>a<span style="color:#f92672">?.</span>method()
</span></span></code></pre></div><hr>
<p><code>?:</code>：如果对象为空则返回后面的值。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> c = <span style="color:#66d9ef">if</span>(a <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span>){
</span></span><span style="display:flex;"><span>	a
</span></span><span style="display:flex;"><span>}<span style="color:#66d9ef">else</span>{
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>等价于：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> c = a <span style="color:#f92672">?:</span> <span style="color:#ae81ff">0</span>
</span></span></code></pre></div><h2 id="非空断言">非空断言</h2>
<p><code>!!</code>：强制忽略空指针异常检查。</p>
<p>如：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> a<span style="color:#f92672">!!</span>.method()
</span></span></code></pre></div><p>无论 a 是否为 null ，都会执行<code>method()</code>。</p>
<h2 id="let-函数实现一次判断">let 函数实现一次判断</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">if</span>(a <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span>){
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>a.method()
</span></span><span style="display:flex;"><span>a.method2()
</span></span></code></pre></div><p>等价于：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>a<span style="color:#f92672">?.</span>let{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">it</span>.method()
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">it</span>.method2()
</span></span><span style="display:flex;"><span>} <span style="color:#75715e">// lambda 表达式
</span></span></span></code></pre></div><h1 id="标准函数">标准函数</h1>
<p>指的是 Standard.kt 文件中定义的函数。前面的 <code>let</code> 也是标准函数。</p>
<h2 id="with">with</h2>
<p>接收一个对象和一个 lambda 表达式，返回 lambda 表达式的执行结果。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> result = with(obj) {
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// obj的上下文
</span></span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;value&#34;</span> <span style="color:#75715e">// with函数的返回值
</span></span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="with-函数应用举例">with 函数应用举例</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> list = listOf(<span style="color:#e6db74">&#34;Apple&#34;</span>, <span style="color:#e6db74">&#34;Banana&#34;</span>, <span style="color:#e6db74">&#34;Orange&#34;</span>, <span style="color:#e6db74">&#34;Pear&#34;</span>, <span style="color:#e6db74">&#34;Grape&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">val</span> builder = StringBuilder()
</span></span><span style="display:flex;"><span>builder.append(<span style="color:#e6db74">&#34;Start eating fruits.</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> (fruit <span style="color:#66d9ef">in</span> list) {
</span></span><span style="display:flex;"><span>	builder.append(fruit).append(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>builder.append(<span style="color:#e6db74">&#34;Ate all fruits.&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">val</span> result = builder.toString()
</span></span><span style="display:flex;"><span>println(result)
</span></span></code></pre></div><p>输出：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>Start eating fruits.
</span></span><span style="display:flex;"><span>Apple
</span></span><span style="display:flex;"><span>Banana
</span></span><span style="display:flex;"><span>Orange
</span></span><span style="display:flex;"><span>Pear
</span></span><span style="display:flex;"><span>Grape
</span></span><span style="display:flex;"><span>Ate all fruits.
</span></span></code></pre></div><p>使用<code>with</code>函数：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> list = listOf(<span style="color:#e6db74">&#34;Apple&#34;</span>, <span style="color:#e6db74">&#34;Banana&#34;</span>, <span style="color:#e6db74">&#34;Orange&#34;</span>, <span style="color:#e6db74">&#34;Pear&#34;</span>, <span style="color:#e6db74">&#34;Grape&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">val</span> result = with(StringBuilder()) {
</span></span><span style="display:flex;"><span>	append(<span style="color:#e6db74">&#34;Start eating fruits.</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> (fruit <span style="color:#66d9ef">in</span> list) {
</span></span><span style="display:flex;"><span>		append(fruit).append(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	append(<span style="color:#e6db74">&#34;Ate all fruits.&#34;</span>)
</span></span><span style="display:flex;"><span>	toString()
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>println(result)
</span></span></code></pre></div><p>with 中传入了 StringBuilder 实例，这样上下文就是 StringBuilder 实例，可以直接调用 append 方法。with 函数的返回值是最后一行代码的返回值，即 toString() 方法的返回值。</p>
<h2 id="run">run</h2>
<p>run 函数在对象的基础上调用，接受一个 lambda 表达式作为参数，返回值是 lambda 表达式的执行结果。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> result = obj.run {
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// obj的上下文
</span></span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;value&#34;</span> <span style="color:#75715e">// run函数的返回值
</span></span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>那么<a href="#with-%E5%87%BD%E6%95%B0%E5%BA%94%E7%94%A8%E4%B8%BE%E4%BE%8B">with函数的例子</a>可以改写为：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> list = listOf(<span style="color:#e6db74">&#34;Apple&#34;</span>, <span style="color:#e6db74">&#34;Banana&#34;</span>, <span style="color:#e6db74">&#34;Orange&#34;</span>, <span style="color:#e6db74">&#34;Pear&#34;</span>, <span style="color:#e6db74">&#34;Grape&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">val</span> result = StringBuilder().run {
</span></span><span style="display:flex;"><span>	append(<span style="color:#e6db74">&#34;Start eating fruits.</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> (fruit <span style="color:#66d9ef">in</span> list) {
</span></span><span style="display:flex;"><span>		append(fruit).append(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	append(<span style="color:#e6db74">&#34;Ate all fruits.&#34;</span>)
</span></span><span style="display:flex;"><span>	toString()
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>println(result)
</span></span></code></pre></div><h2 id="apply">apply</h2>
<p>apply 函数和 run 函数很相似，也是在对象的基础上调用 lambda 表达式，但 apply 函数返回的是对象本身。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> result = obj.apply {
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// obj的上下文
</span></span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;value&#34;</span> <span style="color:#75715e">// apply函数的返回值
</span></span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>改写<a href="#with-%E5%87%BD%E6%95%B0%E5%BA%94%E7%94%A8%E4%B8%BE%E4%BE%8B">with函数的例子</a>：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> list = listOf(<span style="color:#e6db74">&#34;Apple&#34;</span>, <span style="color:#e6db74">&#34;Banana&#34;</span>, <span style="color:#e6db74">&#34;Orange&#34;</span>, <span style="color:#e6db74">&#34;Pear&#34;</span>, <span style="color:#e6db74">&#34;Grape&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">val</span> result = StringBuilder().apply {
</span></span><span style="display:flex;"><span>	append(<span style="color:#e6db74">&#34;Start eating fruits.</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> (fruit <span style="color:#66d9ef">in</span> list) {
</span></span><span style="display:flex;"><span>		append(fruit).append(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	append(<span style="color:#e6db74">&#34;Ate all fruits.&#34;</span>)
</span></span><span style="display:flex;"><span>}.toString() <span style="color:#75715e">// 注意这里的 toString() 方法，是 StringBuilder.toString()
</span></span></span><span style="display:flex;"><span>println(result)
</span></span></code></pre></div><h1 id="静态方法">静态方法</h1>
<p>kotlin 中没有静态方法的概念，但可以通过<strong>单例类</strong>或是<strong>伴生对象</strong>来实现。</p>
<h2 id="单例类-1">单例类</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">object</span> <span style="color:#a6e22e">Utils</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">doAction</span>() {
</span></span><span style="display:flex;"><span>		println(<span style="color:#e6db74">&#34;do action&#34;</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>调用：<code>Utils.doAction()</code></p>
<p>使用单例类会使得类内所有方法都是静态方法。</p>
<h2 id="伴生对象">伴生对象</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Utils</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">doAction1</span>() {
</span></span><span style="display:flex;"><span>		println(<span style="color:#e6db74">&#34;do action1&#34;</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">companion</span> <span style="color:#66d9ef">object</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">doAction2</span>() {
</span></span><span style="display:flex;"><span>			println(<span style="color:#e6db74">&#34;do action2&#34;</span>)
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>调用：<code>Utils.doAction2()</code></p>
<p>对于一个普通类，伴生对象中的方法是静态方法，而类中的方法是实例方法。并且 kotlin 保证伴生对象的唯一性。</p>
<h2 id="真正的静态方法">真正的静态方法</h2>
<h3 id="jvmstatic-注解">@JvmStatic 注解</h3>
<p>kotlin 中的真正的静态方法是使用<code>@JvmStatic</code>注解。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Utils</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">companion</span> <span style="color:#66d9ef">object</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">@JvmStatic</span>
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">doAction</span>() {
</span></span><span style="display:flex;"><span>			println(<span style="color:#e6db74">&#34;do action&#34;</span>)
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>注意， @JvmStatic 注解只能用在伴生对象中或者单例类中的方法上。</p>
<h3 id="顶层方法">顶层方法</h3>
<p>顶层方法指的是那些没有定义在任何类中的方法。</p>
<p>想要定义顶层方法，需要在 <strong>kotlin 文件</strong>中直接定义函数，而不是定义在类中。（参考<a href="#hello-kotlin">hello kotlin</a>）</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#75715e">// Utils.kt
</span></span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">doAction</span>() {
</span></span><span style="display:flex;"><span>	println(<span style="color:#e6db74">&#34;do action&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>如果是在 java 中调用这个方法，需要使用类名调用。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// Java</span>
</span></span><span style="display:flex;"><span>UtilsKt.<span style="color:#a6e22e">doAction</span>();
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 编译器自动生成一个 UtilsKt 类，其中包含了 doAction 方法</span>
</span></span></code></pre></div><p>如果是在 kotlin 中调用，直接调用即可。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#75715e">// Kotlin
</span></span></span><span style="display:flex;"><span>doAction()
</span></span></code></pre></div>
</main>

  <footer>
  
  
  <hr/>
  © 2026 xici&rsquo;s Web Note. Powered by <a href="https://gohugo.io">Hugo</a>.
  
  </footer>
  </body>
</html>
